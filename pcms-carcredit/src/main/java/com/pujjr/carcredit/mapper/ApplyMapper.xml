<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pujjr.carcredit.dao.ApplyMapper">
  <resultMap id="BaseResultMap" type="com.pujjr.carcredit.domain.Apply">
    <id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="APP_ID" jdbcType="VARCHAR" property="appId" />
    <result column="PRODUCT_CODE" jdbcType="VARCHAR" property="productCode" />
    <result column="PERIOD" jdbcType="INTEGER" property="period" />
    <result column="COMMENT" jdbcType="VARCHAR" property="comment" />
    <result column="STATUS" jdbcType="VARCHAR" property="status" />
    <result column="CREATE_BRANCH_CODE" jdbcType="VARCHAR" property="createBranchCode" />
    <result column="CREATE_ACCOUNT_ID" jdbcType="VARCHAR" property="createAccountId" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <result column="CUST_TYPE" jdbcType="VARCHAR" property="custType" />
    <result column="TOTAL_FINANCE_AMT" jdbcType="DOUBLE" property="totalFinanceAmt" />
    <result column="TOTAL_LOAN_AMT" jdbcType="DOUBLE" property="totalLoanAmt" />
    <result column="MONTH_RENT" jdbcType="DOUBLE" property="monthRent" />
    <result column="APPROVE_DATE" jdbcType="DATE" property="approveDate" />
    <result column="PROC_INST_ID" jdbcType="VARCHAR" property="procInstId" />
  </resultMap>
  <sql id="Base_Column_List">
    ID, APP_ID, PRODUCT_CODE, PERIOD, COMMENT, STATUS, CREATE_BRANCH_CODE, CREATE_ACCOUNT_ID, 
    CREATE_TIME, CUST_TYPE, TOTAL_FINANCE_AMT, TOTAL_LOAN_AMT, MONTH_RENT, APPROVE_DATE, 
    PROC_INST_ID
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from t_apply
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    delete from t_apply
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.pujjr.carcredit.domain.Apply">
    insert into t_apply (ID, APP_ID, PRODUCT_CODE, 
      PERIOD, COMMENT, STATUS, 
      CREATE_BRANCH_CODE, CREATE_ACCOUNT_ID, CREATE_TIME, 
      CUST_TYPE, TOTAL_FINANCE_AMT, TOTAL_LOAN_AMT, 
      MONTH_RENT, APPROVE_DATE, PROC_INST_ID
      )
    values (#{id,jdbcType=VARCHAR}, #{appId,jdbcType=VARCHAR}, #{productCode,jdbcType=VARCHAR}, 
      #{period,jdbcType=INTEGER}, #{comment,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, 
      #{createBranchCode,jdbcType=VARCHAR}, #{createAccountId,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, 
      #{custType,jdbcType=VARCHAR}, #{totalFinanceAmt,jdbcType=DOUBLE}, #{totalLoanAmt,jdbcType=DOUBLE}, 
      #{monthRent,jdbcType=DOUBLE}, #{approveDate,jdbcType=DATE}, #{procInstId,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.pujjr.carcredit.domain.Apply">
    insert into t_apply
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="appId != null">
        APP_ID,
      </if>
      <if test="productCode != null">
        PRODUCT_CODE,
      </if>
      <if test="period != null">
        PERIOD,
      </if>
      <if test="comment != null">
        COMMENT,
      </if>
      <if test="status != null">
        STATUS,
      </if>
      <if test="createBranchCode != null">
        CREATE_BRANCH_CODE,
      </if>
      <if test="createAccountId != null">
        CREATE_ACCOUNT_ID,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="custType != null">
        CUST_TYPE,
      </if>
      <if test="totalFinanceAmt != null">
        TOTAL_FINANCE_AMT,
      </if>
      <if test="totalLoanAmt != null">
        TOTAL_LOAN_AMT,
      </if>
      <if test="monthRent != null">
        MONTH_RENT,
      </if>
      <if test="approveDate != null">
        APPROVE_DATE,
      </if>
      <if test="procInstId != null">
        PROC_INST_ID,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="appId != null">
        #{appId,jdbcType=VARCHAR},
      </if>
      <if test="productCode != null">
        #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="period != null">
        #{period,jdbcType=INTEGER},
      </if>
      <if test="comment != null">
        #{comment,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="createBranchCode != null">
        #{createBranchCode,jdbcType=VARCHAR},
      </if>
      <if test="createAccountId != null">
        #{createAccountId,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="custType != null">
        #{custType,jdbcType=VARCHAR},
      </if>
      <if test="totalFinanceAmt != null">
        #{totalFinanceAmt,jdbcType=DOUBLE},
      </if>
      <if test="totalLoanAmt != null">
        #{totalLoanAmt,jdbcType=DOUBLE},
      </if>
      <if test="monthRent != null">
        #{monthRent,jdbcType=DOUBLE},
      </if>
      <if test="approveDate != null">
        #{approveDate,jdbcType=DATE},
      </if>
      <if test="procInstId != null">
        #{procInstId,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.pujjr.carcredit.domain.Apply">
    update t_apply
    <set>
      <if test="appId != null">
        APP_ID = #{appId,jdbcType=VARCHAR},
      </if>
      <if test="productCode != null">
        PRODUCT_CODE = #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="period != null">
        PERIOD = #{period,jdbcType=INTEGER},
      </if>
      <if test="comment != null">
        COMMENT = #{comment,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        STATUS = #{status,jdbcType=VARCHAR},
      </if>
      <if test="createBranchCode != null">
        CREATE_BRANCH_CODE = #{createBranchCode,jdbcType=VARCHAR},
      </if>
      <if test="createAccountId != null">
        CREATE_ACCOUNT_ID = #{createAccountId,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="custType != null">
        CUST_TYPE = #{custType,jdbcType=VARCHAR},
      </if>
      <if test="totalFinanceAmt != null">
        TOTAL_FINANCE_AMT = #{totalFinanceAmt,jdbcType=DOUBLE},
      </if>
      <if test="totalLoanAmt != null">
        TOTAL_LOAN_AMT = #{totalLoanAmt,jdbcType=DOUBLE},
      </if>
      <if test="monthRent != null">
        MONTH_RENT = #{monthRent,jdbcType=DOUBLE},
      </if>
      <if test="approveDate != null">
        APPROVE_DATE = #{approveDate,jdbcType=DATE},
      </if>
      <if test="procInstId != null">
        PROC_INST_ID = #{procInstId,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.pujjr.carcredit.domain.Apply">
    update t_apply
    set APP_ID = #{appId,jdbcType=VARCHAR},
      PRODUCT_CODE = #{productCode,jdbcType=VARCHAR},
      PERIOD = #{period,jdbcType=INTEGER},
      COMMENT = #{comment,jdbcType=VARCHAR},
      STATUS = #{status,jdbcType=VARCHAR},
      CREATE_BRANCH_CODE = #{createBranchCode,jdbcType=VARCHAR},
      CREATE_ACCOUNT_ID = #{createAccountId,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      CUST_TYPE = #{custType,jdbcType=VARCHAR},
      TOTAL_FINANCE_AMT = #{totalFinanceAmt,jdbcType=DOUBLE},
      TOTAL_LOAN_AMT = #{totalLoanAmt,jdbcType=DOUBLE},
      MONTH_RENT = #{monthRent,jdbcType=DOUBLE},
      APPROVE_DATE = #{approveDate,jdbcType=DATE},
      PROC_INST_ID = #{procInstId,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <!-- ��ѯδ�ύ���� -->
  <resultMap id="applyVoResultMap" type="com.pujjr.carcredit.vo.ApplyVo">
  	<id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="APP_ID" jdbcType="VARCHAR" property="appId" />
    <result column="PRODUCT_CODE" jdbcType="VARCHAR" property="productCode" />
    <result column="PERIOD" jdbcType="INTEGER" property="period" />
    <result column="COMMENT" jdbcType="VARCHAR" property="comment" />
    <result column="STATUS" jdbcType="VARCHAR" property="status" />
    <result column="CREATE_BRANCH_CODE" jdbcType="VARCHAR" property="createBranchCode" />
    <result column="CREATE_ACCOUNT_ID" jdbcType="VARCHAR" property="createAccountId" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <!-- <association column="APP_ID" property="familyDebt" select="selectFamilyDebt"></association>
    <collection column="APP_ID" property="linkmans" ofType="com.pujjr.carcredit.vo.ApplyLinkmanVo" select="selectLinkmans"></collection>
    <collection column="APP_ID" property="finances" ofType="com.pujjr.carcredit.vo.ApplyFinanceVo" select="selectFinances"/> -->
  </resultMap>
  <select id="selectByMap" parameterType="java.util.HashMap" resultMap="applyVoResultMap">
  	select 
  	<include refid="Base_Column_List" />
  	from t_apply
  	where CREATE_ACCOUNT_ID = #{accountId} and STATUS = #{status}
  </select>
  
  <select id="selectApplyByMap" parameterType="java.lang.String" resultMap="applyVoResultMap">
  	select 
  	<include refid="Base_Column_List" />
  	from t_apply
  	where app_id=#{appId}
  </select>
  
  <select id="selectByAppid" parameterType="java.lang.String" resultMap="BaseResultMap">
  	select 
  	<include refid="Base_Column_List" />
  	from t_apply
  	where app_id = #{appId}
  </select>
  
  <update id="updateByAppidSelective" parameterType="com.pujjr.carcredit.domain.Apply">
  	update t_apply
  	<set>
  		<if test="productCode != null">
  		 	PRODUCT_CODE = #{productCode},
  		</if>
  		<if test="period != null">
  			PERIOD = #{period,jdbcType=INTEGER},
  		</if>
  		<if test="comment != null">
  			comment = #{comment},
  		</if>
  	</set>
  	where app_id = #{appId}
  </update>
  
   <resultMap id="ApplyInfoResultMap" type="com.pujjr.carcredit.po.ApplyInfoPo">
    <result column="appId" jdbcType="VARCHAR" property="appId" />
    <result column="productName" jdbcType="VARCHAR" property="productName" />
    <result column="tenantName" jdbcType="VARCHAR" property="tenantName" />
    <result column="tenantIdNo" jdbcType="VARCHAR" property="tenantIdNo" />
    <result column="totalFinanceAmt" jdbcType="VARCHAR" property="totalFinanceAmt" />
    <result column="period" jdbcType="INTEGER" property="period" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="status" jdbcType="VARCHAR" property="status" />
  </resultMap>
  
  <select id="selectApplyInfoList" resultMap="ApplyInfoResultMap">
  	select 
  	a.APP_ID as appId,
  	c.PRODUCT_NAME as productName,
  	b.NAME as tenantName,
  	b.ID_NO as  tenantIdNo,
  	a.PERIOD as period,
  	a.CREATE_TIME as createTime,
  	d.DICT_DATA_NAME as status
  	from t_apply a 
  	left join t_apply_tenant b on a.APP_ID = b.APP_ID
  	left join t_product c on a.PRODUCT_CODE = c.PRODUCT_CODE 
  	left join sys_dict_data d on a.STATUS = d.DICT_DATA_CODE
  	where 1= 1
  	<if test="accountId != null and accountId!=''">
  		and a.CREATE_ACCOUNT_ID = #{accountId}
  	</if>
  	<if test="status !=null and status!=''">
  		and a.STATUS =#{status}
  	</if>
  </select>
</mapper>